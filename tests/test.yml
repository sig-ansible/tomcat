---
- hosts: all
  become: yes
  become_user: root

  vars:
    stage_dir: /tmp
    tomcat_java_home: /usr/lib/jvm/jre-1.8.0
    tomcat_uid: 601
    tomcat_gid: 601
    tomcat_add_jars:
      - /mnt/artifacts/ojdbc7.jar
    tomcat_log_retain_days: 1
    tomcat_censor_ansible_output: no

  # pre_tasks:
  #   - name: Install required packages
  #     yum:
  #       name:
  #         - java-1.8.0-openjdk
  #         # - pyOpenSSL        # RHEL 7

  #         # RHEL 8
  #         # - python3-pyOpenSSL
  #         # - python36

  #   # RHEL 8
  #   # - name: Install pip packages
  #   #   pip:
  #   #     name:
  #   #       - lxml

  roles:
    - name: about

    - name: tomcat
      tomcat_service_name: tomcat_b
      tomcat_port_offset: 1000
      tomcat_ca_signed: yes
      tomcat_ca_signed_cert_chain_armored: |
        -----BEGIN CERTIFICATE-----
        MIIFwTCCA6mgAwIBAgIUPGXYQavoihLrB8WGQVkPE64TyF0wDQYJKoZIhvcNAQEL
        BQAwbzELMAkGA1UEBhMCVVMxEjAQBgNVBAgMCUxvdWlzaWFuYTESMBAGA1UEBwwJ
        QWJiZXZpbGxlMQwwCgYDVQQKDANTSUcxCzAJBgNVBAsMAklUMR0wGwYDVQQDDBR0
        ZXN0LnRvbWNhdC53aGF0ZXZlcjAgFw0yMzAyMjQxNTEzMjNaGA8yMDUwMDcxMTE1
        MTMyM1owbzELMAkGA1UEBhMCVVMxEjAQBgNVBAgMCUxvdWlzaWFuYTESMBAGA1UE
        BwwJQWJiZXZpbGxlMQwwCgYDVQQKDANTSUcxCzAJBgNVBAsMAklUMR0wGwYDVQQD
        DBR0ZXN0LnRvbWNhdC53aGF0ZXZlcjCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCC
        AgoCggIBAOzEmQMysd6AQ54URLJRdAPbW5XkumulGmNCtVAd4tNAO1AgK20vX+E8
        IuwX1jmucZBaJQPN5wAoU39mwRzkGqMrjDu8x6qLJbjiMgLn6u+hRVJTm/8FHQgn
        5X+XYIEvupgUIzuw9Dnjdfa8guCOWtdPOm29L4Z6xPYUiu4+XALYFlqkZY1ApGGf
        89QhtKDnq+PcFZSeeIqUzsQWXHrMOC7bfklyq2gz/2sNtfBblIIwXC282e105Ht+
        zWF4caIr59+P90pR6Mfm9cqwdivDJ9QdxHwnOe/IDTiM6+SxlLflG/tvj6Rkkt5A
        LoTKq+ttY7F5lHCizubMhlO2dMzfz+a7gYXSn+cFZysChJmE+fidwTDllQysRM32
        qoaEN1ZvH9lYx46nzX7A7m9MWc4FcHXpP/QpSX4MtU1GiGcd4kUkfIG3cUf6zBp0
        IGenIdWs1fMqFodi8sbCtMPB40BExSVwXK+WwZp29pPyI+Y+C0jeht6S56rvg7Te
        /LpkCD9YI2QzmqqtwtQqgdDfSWICdbTLvbfCEUO39bdSNAh/wlQ7gWVWTUg23Uqp
        +F+cUkZHC/yFFGKz0r8pxUVuzBnLEZrY7yCVyr1UIE2LuxC0z/lGqcYMMq3lugO6
        ufvPOG3CmgqEkjtBEmWhPpqCnW98/H1gESvOn3adVqLcjxUTqWgrAgMBAAGjUzBR
        MB0GA1UdDgQWBBTPSPs0AEOwRvbHkTa14CLs4+OI5zAfBgNVHSMEGDAWgBTPSPs0
        AEOwRvbHkTa14CLs4+OI5zAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3DQEBCwUA
        A4ICAQDlxW12nT+proM78AIpFD3eL4Bn7Z9bv1dZAEacvDfKfS5ktewCdjweMoFr
        YkanExoWnN71vk8IE1ktnOF25FgFjyYVj6mnffMIGASsx180cHGfUp1oVnnSp0JQ
        BzRGIMB0uYE3LJLJn8xFuzgpFLwEV368oMRH4pQFi1iRIQMToXkxFfm9JdBBKsbc
        VSoZ0TM6JxNhPKe+eMTXNAS6bzLfvrGwiEXJLKgJBD6luXsCHxMb4NYCuWYhRRdR
        0lV7Tqa6oHBRihNduWwJLAY9ZvzTQlfNPoOki+IFnCXEwzCdxLQ/3w2PzVYTzTbP
        EUzBq+XFioD7T4QriUtBndH+iKzUQIt0aAhBHeSiWJgpmbZ3xQ5yO01LJVYRRuRj
        W4kGo19xkqcXQVJEBoaCbwYMvIqJ0NMOGDmPVBx5DunPQVJmSJ7dEhtH7TEcYoY6
        GPRofJst4VzoEyboSnnvnhsYkPoASCrObsEAfpGv06qSARz1ARYz6qHqaYCZYFS2
        aU8w+jBD3TQGGFfo/fo5o++1A0MPWguEPMavzcHXDGduN7LAqKQZ8DCizc+syxij
        YLSkQatvsdjJZS44RXrBwppidlKW+H2ltrmjb+Z4mM5MLR5wDPHir+9lIU1wQF6f
        /mzWBbKIR7zwCrDpiPn99QUQiDwGXnHBYZdUeh5fWelJ0x4V9w==
        -----END CERTIFICATE-----
      tomcat_ca_signed_key_armored: |
        -----BEGIN ENCRYPTED PRIVATE KEY-----
        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
        994Sc4L9nDCWqWuRUqjZPA==
        -----END ENCRYPTED PRIVATE KEY-----

    - name: tomcat
      tomcat_service_name: tomcat_a
      tomcat_self_signed: yes
      tomcat_max_http_header_size: 12288
      tomcat_resources:
        - name: someResource
          attrs:
            auth: Container
            defaultAutoCommit: true
            driverClassName: oracle.jdbc.OracleDriver
            initialSize: 10
            maxIdle: 10
            maxTotal: 100
            maxWaitMillis: 30000
            minIdle: 10
            password: somepassword
            testOnBorrow: true
            testWhileIdle: true
            timeBetweenEvictionRunsMillis: 1800000
            type: javax.sql.DataSource
            url: jdbc:oracle:thin:@localhost:1521:ASID
            username: dwschema
            validationQuery: select * from dual
            validationQueryTimeout: 300
      tomcat_resource_links:
        - name: someResource
          global_name: someGlobalName
      tomcat_users:
        - name: someguy
          password: somepassword
          roles: arole,somerole
          append: yes

